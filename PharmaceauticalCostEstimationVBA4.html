Sub mjknjknj()

Dim i, count, count2, k1, k2, x, c2, c3 As Integer
Dim sum, sum2 As Double

Dim sh7 As Worksheet
Dim dos As Date

Set sh7 = ActiveWorkbook.Sheets("Labs")
i = 2
count = 0
count2 = 0
k1 = 2
k2 = 3
c2 = 2
c3 = 2
sum = 0
sum2 = 0
lngLastRow = Range("A" & Rows.count).End(xlUp).Row
Do While i < lngLastRow
    If Cells(k1, 2).Value = "Med A" And Cells(k2, 2).Value = "Med B" And Cells(k1, 1).Value = Cells(k2, 1).Value Then
    
    dos = Cells(k2, 3).Value
    
    Do While sh7.Cells(c2, 1).Value <> Cells(k1, 1).Value
        
        c2 = c2 + 1
        'Cells(c2, 8).Value = c2
    Loop
    Do While sh7.Cells(c2, 1).Value = sh7.Cells(c2 + 1, 1).Value
        
    
        If sh7.Cells(c2, 3) = "LAB B" And sh7.Cells(c2, 2).Value < dos Then
        'Cells(c2, 9).Value = c2
        sum = sum + sh7.Cells(c2, 4)
        count = count + 1
        End If
        
        If sh7.Cells(c2, 3) = "LAB B" And sh7.Cells(c2, 2).Value > dos Then
        'Cells(c2, 9).Value = c2
         sum2 = sum2 + sh7.Cells(c2, 4)
         count2 = count2 + 1
        End If
        c2 = c2 + 1
    Loop
    c3 = c2
    'Cells(c2, 8).Value = c3
    'Do While sh7.Cells(c3, 1).Value = sh7.Cells(c3 + 1, 1).Value
        
    
        'If sh7.Cells(c3, 3) = "LAB B" And sh7.Cells(c3, 2).Value > dos Then
        'Cells(c2, 9).Value = c2
        'sum2 = sum2 + sh7.Cells(c3, 4)
       ' count2 = count2 + 1
       ' End If
        'c3 = c3 + 1
   ' Loop
    
    
    End If
    i = i + 1
    k1 = k1 + 1
    k2 = k2 + 1
    
    
Loop
Cells(2, 9).Value = sum / count

Cells(4, 9).Value = sum2 / count2
End Sub




